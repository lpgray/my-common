/*! gtmap 2013-09-11 */
function beforeRemove(){$(".j_btn_del,.j_ask").click(function(){var a=$(this).attr("data-ask")||"确定执行删除操作吗？";return window.confirm(a)})}Utils.ajax4data=function(){$(document).delegate(".a4d","click",function(){var a,b,c=$(this).attr("data-url")||$(this).attr("href"),d=$(this).attr("data-result-ctn"),e="";return d?(-1!==d.search(/\(/)?(a=d.substring(d.indexOf("(")+1,d.indexOf(")")),d=d.substring(0,d.indexOf("("))):a="html",b=$(d),loading.show("正在请求数据"),c&&(e=c.indexOf("?")>-1?"&d=":"?d=",c&&$.ajax({url:c+e+(new Date).getMilliseconds(),dataType:"html",success:function(c){b[a](c),b.find("form").validationEngine(),loading.hide()}})),!1):(alert("没有设定存放结果的容器选择符"),!1)})},Utils.ajax4data(),$(document).on("click",'[href="#"],.disabled',function(a){a.preventDefault()}),function(){for(var a,b=function(){},c=["assert","clear","count","debug","dir","dirxml","error","exception","group","groupCollapsed","groupEnd","info","log","markTimeline","profile","profileEnd","table","time","timeEnd","timeStamp","trace","warn"],d=c.length,e=window.console=window.console||{};d--;)a=c[d],e[a]||(e[a]=b)}(),$(document).ready(function(){function a(a){var b=!1;return $(a).find("form").find('input[type="checkbox"]').each(function(){var a=$(this),c=a.is(":checked"),d=a.data("initStatus");void 0===d&&(d=a.attr("data-init-status")),c!=d&&(b=!0)}),b}function b(){var a=!1;$(".j_save").each(function(){$(this).is(":visible")&&(a=!0)}),a?$("#J_BTN_SAVE_ALL").fadeIn(function(){$(this).css("display","inline-block")}):$("#J_BTN_SAVE_ALL").css("display","none")}function c(a,b){"success"===a?(alerts("授权成功",a),$(b).find("form").find('form input[type="checkbox"]').each(function(){var a=$(this);a.data("initStatus",a.is(":checked"))}),$(b).find(".j_save").css("display","none")):alerts(a,"error")}function d(a){$(a).find("form").find('input[type="checkbox"]').each(function(){$(this).data("initStatus",$(this).is(":checked")),$(this).attr("data-init-status",$(this).is(":checked"))})}$("tbody").children("tr").each(function(){d(this)}),$("tbody").delegate("input[type=checkbox]","change",function(){var c=$(this).parents("tr")[0];a(c)?$(c).children("td:last-child").children(".j_save").fadeIn(function(){$(this).css("display","inline-block")}):$(c).children("td:last-child").children(".j_save").css("display","none"),b()}),$("tbody").delegate(".j_save","click",function(){var a=$(this).parents("tr")[0];$(a).find("form").ajaxSubmit({callback:function(b){c(b,a)}})}),$("#J_BTN_SAVE_ALL").click(function(){$.browser.msie&&loading.show("正在保存"),$(".j_save:visible").click(),$(this).css("display","none"),$.browser.msie&&loading.hide()}),$(document).delegate(".j_check_all","click",function(){var a=$(this),b=a.parents("tr")[0],c=$(b).find("form").find('input[type="checkbox"]');$(this).is(":checked")?$(this).parent("span").addClass("checked"):$(this).parent("span").removeClass("checked"),c.each(function(){$(this).attr("disabled")||this.checked==a.is(":checked")||(this.checked=a.is(":checked"),$(this).is(":checked")?$(this).parent("span").addClass("checked"):$(this).parent("span").removeClass("checked"),$(this).trigger("change"))})})}),Utils.pagin=function(a,b,c,d,e,f){function g(){var a,b=h.children("span").children("a"),c=h.children("span").children(".active"),d=[];if(b.length>e){a=c.index()+1,b.each(function(c){return d.length>=e?!1:(c+=1,c===a||c===a-1||c===a+1||1===c||2===c||c===b.length-1||c===b.length?(d.push(c),void 0):void 0)});for(var f=a-2;f>2&&!(d.length>=e);f--)d.contains(f)||d.push(f);for(var f=a+2;f<b.length-1&&!(d.length>=e);f++)d.contains(f)||d.push(f);d.sort(function(a,b){return a>b}),b.each(function(a){a+=1,d.contains(a)||$(this).remove()}),b=h.children("span").children("a");for(var f=1;f<d.length;f++)d[f]-d[f-1]>1&&$(b[f-1]).after("<strong> ... </strong>")}}Array.prototype.contains=function(a){for(i in this)if(this[i]==a)return!0;return!1};var h=$(a),j="page.page",k="page.size",l=h.children(".prev"),m=h.children(".next"),n=location.href,o="?";o=f?f:n.indexOf("?")>-1&&-1==n.indexOf(j)?n+"&":n.indexOf(j)>-1?n.substring(0,n.indexOf(j)):"?";var p=Math.ceil(d/c);for(1==b&&l.addClass("disabled"),b==p&&m.addClass("disabled"),h.children("span").children().remove(),i=1;p>=i;i++){var q=$("<a />").attr({href:o+j+"="+i+"&"+k+"="+c}).html(i);h.children("span").append(q),i==b&&(q.addClass("active"),q.attr("href","#"))}l.attr({href:o+j+"="+(b-1)+"&"+k+"="+c}),m.attr({href:o+j+"="+(b+1)+"&"+k+"="+c}),g(b),h.find("a").addClass("j_pagin_link")},function(a){a.fn.ajaxSubmit=function(b){this.validationEngine();var c=this;if(!c.attr("action"))return alert(c.attr("id")+"的action没有设定"),void 0;if(c.validationEngine("validate"))return b.loading&&loading.show(b.loading),a.ajax({url:c.attr("action"),type:c.attr("method")||"get",data:c.serialize(),dataType:"html",success:function(a){b.callback&&b.callback(a),loading.hide()}}),this}}(jQuery),function(a){var b=function(a){this.opts=a},c={tpl:"<a href='#' class='_linkremove j_btn_del remove hide' style='position:absolute;top:0;right:0;-webkit-transition: display .5s ease .5s;text-decoration: none;' onclick='$(this).parent().slideUp()'>×</a>",style:{color:"white","background-color":"#CE3939",padding:"5px 15px",font:"normal bold 30px arial","border-radius":"0 5px 0 0"}};b.prototype={render:function(b){var c=a(this.opts.tpl);return b&&c.attr("href",b),c.css(this.opts.style),c}},a.fn.closeremove=function(d){return this.each(function(){var e=a(this),f=a.extend(!0,{},c,d);e.css("position","relative"),$link=new b(f).render(e.attr("data-url")),e.append($link),e.hover(function(){a(this).children("._linkremove").css("display","block")},function(){a(this).children("._linkremove").css("display","none")})})}}(jQuery),function(a){var b=function(b){this.elem=a(b)},c={tpl:'<div class="final-panel j_final_panel hide"><a href="#" class="btn btn-mini j_reset"><i class="icon-remove-circle"></i> 撤销更改</a> <a href="#" class="btn btn-primary btn-mini j_confirm"><i class="icon-ok-sign icon-white"></i> 保存更改</a></div>',reset:function(){alert("点击撤销")},confirm:function(){alert("点击保存")}};b.prototype={show:function(){var a=this.elem;a.hasClass("fix-top")||a.fadeIn(500,function(){a.addClass("fix-top")})},hide:function(){var a=this.elem;a.hasClass("fix-top")&&a.fadeOut(500,function(){a.removeClass("fix-top")})}},a.fn.confirms=function(d){var e,f,g=this.children(".j_final_panel");return g.length||(e=a.extend({},c,d),this.css("position","relative"),this.append(e.tpl),g=this.children(".j_final_panel"),this.children(".j_final_panel").children(".j_reset").click(function(){e.reset(),f.hide()}),this.children(".j_final_panel").children(".j_confirm").click(function(){e.confirm(),f.hide()})),this.data("confirmpanel")?f=this.data("confirmpanel"):this.data("confirmpanel",f=new b(g)),f.show(),this}}(window.jQuery),function(a){var b=function(b,c){var b=a(b),d=b.css("background-color");b.css("background-color",c.color),b.animate({"background-color":d},1e3)};a.fn.focusresult=function(c){var d=a.extend({},c,a.fn.focusresult.defaults);return b(this,d),this},a.fn.focusresult.defaults={color:"red",duration:1e3}}(jQuery),function(a){a.fn.serializeObject=function(){var b,c=function(a){return a=a.replace(/"/g,'\\"').replace(/'/g,'\\"').replace(/‘/g,'\\"').replace(/’/g,'\\"').replace(/“/g,'\\"').replace(/”/g,'\\"')},d={},e=this.serializeArray(),f={};return a.each(e,function(){if(this.value=c(this.value),this.name.indexOf(".")>-1){var e=this.name.split(".");for(i=0;i<e.length;i++)0==i?(f[e[i]]=f[e[i]]?a.extend({},f[e[i]]):{},b=f[e[i]]):i==e.length-1?b[e[i]]=this.value||"":(b[e[i]]=b[e[i]]?a.extend({},b[e[i]]):{},b=b[e[i]]);return d[e[0]]=d[e[0]]?a.extend({},d[e[0]],f[e[0]]):f[e[0]],void 0}void 0!==d[this.name]?(d[this.name].push||(d[this.name]=[d[this.name]]),d[this.name].push(this.value||"")):d[this.name]=this.value||""}),d}}(jQuery),function(a){"use strict";var b={fetchCallback:null,hideCallback:function(a){a.find(".icon-folder-open").addClass("icon-folder-close").removeClass("icon-folder-open")},openCallback:function(a){console.log(a),a.find(".icon-folder-close").removeClass("icon-folder-close").addClass("icon-folder-open")}},c=function(b,c){this.options=b,this.elem=a(c),this.init()};c.prototype={init:function(){var b=this;a(b.elem).children("tr,li").each(function(){b.renderItem(this)}),a(b.elem).delegate("._treetoggle","click",function(){b.move(a(this).parents("li,tr")[0])})},renderItem:function(b){if(!a(b).find("._treetoggle, ._root").length){var c=this.parentNumber(b),d=this.childrenStatus(b);return this.addPrefix(c,d,b),b}},parentNumber:function(b){var c=a(b).attr("data-parent"),d=0;return c&&(d+=1,d+=this.parentNumber("#"+c)),d},childrenStatus:function(b){var c=a('[data-parent="'+a(b).attr("id")+'"]').length?1:0;return c||"true"!==a(b).attr("data-has-child")||(c=2),c},move:function(b){var c=a(b).attr("id"),d=a(b).find("._treetoggle"),e=this.childrenStatus(b);d.hasClass("_open")?this.hideChildren(c):d.hasClass("_close")&&1===e?(this.elem.find("[data-parent="+c+"]").removeClass("hide"),a(b).find("._close").removeClass("_close").addClass("_open"),this.options.openCallback(a(b))):this.fetch(b)},hideChildren:function(b){var c=this;this.elem.find("[data-parent="+b+"]").each(function(){a(this).addClass("hide"),c.hideChildren(a(this).attr("id"))}),a("#"+b).find("._open").removeClass("_open").addClass("_close"),c.options.hideCallback(a("#"+b))},addPrefix:function(b,c,d){var e,f="<i class='ico ico-blank'></i>",g="<i class='_treetoggle ico _open'></i>",h="<i class='_treetoggle ico _close'></i>",i="<i class='ico _root'></i>";switch(e=a(d).children("td:first-child").length?a(d).children("td:first-child"):a(d).children("a"),e.html("<span>"+e.html()+"</span>"),c){case 1:e.prepend(g);break;case 0:e.prepend(i);break;case 2:e.prepend(h)}for(var j=0;b>j;j++)e.prepend(f)},fetch:function(b){var c=this,d=a(b).attr("data-url");return d?(d&&a.ajax({url:d,dataType:"html",success:function(d){var e=a("<div />");e.html(d),a(b).after(e.html()).find("._treetoggle").removeClass("_close").addClass("_open"),a(a(b).parents("ul,table")[0]).children("tr,li").each(function(){c.renderItem(this)})}}),void 0):(alert("没有设置标签属性data-url"),void 0)}},a.fn.listtree=function(d){return this.each(function(){a(this).addClass("_listtree");var e=a.extend({},b,d),f=a(this).data("tree");f||a(this).data("tree",f=new c(e,this))})},a.fn.gridtree=function(d){return this.each(function(){var e=a.extend({},b,d);a(this).addClass("_gridtree");var f=a(this).data("tree");f||a(this).data("tree",f=new c(e,this))})}}(jQuery),function(a){a.infopane={},a.infopane.show=function(b,c,d){a.infopane.pane=a.infopane.pane||a("#_infopane"),b&&a.infopane.setText(b),c&&a.infopane.pane.attr("class",c)||a.infopane.pane.attr("class",""),a.infopane.pane.fadeIn("fast",d)},a.infopane.setText=function(b){a.infopane.pane.html(b)},a.infopane.hide=function(){a.infopane.pane.fadeOut()},a.infopane.animate=function(b,c){a.infopane.show(b,c,function(){setTimeout(a.infopane.hide,800)})}}(jQuery),function(a){var b=function(){return this};b.prototype={tmpl:"<div id='_loadingWrap' class='._loading_wrap'><div class='_inner'><div class='_main'></div><div class='_cover'></div></div></div>",show:function(b,c){a("._loading_wrap").remove();var d,e=c||"body",f=b||"正在努力加载",g=a(this.tmpl);this.elem=g,d=this.elem.find("._main"),d.html(f),a(e).css("position","relative").append(this.elem),this.elem.css("display","block"),d.css("margin-left","-"+d.outerWidth()/2+"px")},hide:function(){this.elem.fadeOut("fast",function(){a("._loading_wrap").remove()})}},window.loading=new b}(jQuery),function(a){var b=function(b){this.slider=a(b).find(".slider"),this.toggles=a(b).find(".toggles").children("a"),this.items=this.slider.children("li"),this.items.css("display","none"),this.showByIdx(0),this.autoRun()};b.prototype={showByIdx:function(b){if(this.current!==b){var c=this,d=a(c.items[b]).find(".banner-desc"),e=0;return this.items.fadeOut(),this.items.find(".banner-desc").animate({opacity:0,top:e-20+"px"},600),a(this.items[b]).fadeIn(800,function(){d.animate({opacity:1,top:e+"px"},400)}),this.current=b,this.showToggleByIdx(b),b}},showToggleByIdx:function(b){a(this.toggles).addClass("cloze").removeClass("open"),a(this.toggles[b]).removeClass("cloze").addClass("open")},autoRun:function(a){var b=a?a:0,c=this;this.funcAuto=setInterval(function(){c.current===c.items.length-1&&(b=0),c.showByIdx(b),b++},8e3)}},a.fn.slider=function(){var c=new b(this);this.find(".toggles").children("a").click(function(){clearInterval(c.funcAuto),c.showByIdx(a(this).index())})}}(jQuery);